# java server pages
## a simple jsp
```html
<%@page import="java.io.PrintWriter"%>
<%@page import="java.util.Date"%>
<%@page contentType="text/html" pageEncoding="UTF-8"%>

<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title> JSP </title>
	</head>
	<body>
		<% Date today = new Date(); %>
		<h1> Hello, today is <%=today%> </h1>
		<h2>
			<%
				PrintWriter writer = new PrintWriter(out);
				writer.printf("Just another %tA in the month of %tB in the year %tY%n", today, today, today);
			%>
		</h2>
	</body>
</html>
```

```html
<%@page import="java.util.Date"%>
```
like an import in regular java

```html
<%@page import="java.util.Date"%>
```
a jsp _scriptlet_, i.e. Java in the JSP. This is executed every time the page is requested.
the text inside the <% â€¦ %> is a longer example

```html
PrintWriter writer = new PrintWriter(out);
```
giving the printwriter the output out, which is a predefined jsp variable

```html
<%=today%>
```
a jsp expression, also evaluated every time the page is requested

---
## how are jsps executed?
the first time it's requested, it is converted into a servlet, the compiled to a .class file, then ran
![[Pasted image 20231128140953.png]]

### jsp lifecycle
![[Pasted image 20231128141107.png]]
when the jsp is converted into a class and loaded into the servlet container, it is ready to be called
when called first, it is initialised (jspInit)
every subsequent request is handled by the jspService method

---
## jsp predefined variables
some examples
- out
- request
- response
- session
- application
```java
public void _jspService(HttpServletRequest request, HttpServletResponse response) throws java.io.IOException, ServletException {
	JspFactory _jspFactory = JspFactory.getDefaultFactory();
	PageContext pageContext = pageContext.getSession();
	ServletContext application = pageContext.getSession();
	ServletConfig config = pageContext.getServletConfig();
	JspWriter out = pageContext.getOut();
	Object page = this;
}
```

![[Pasted image 20231128141328.png]]

---
## parts of a jsp
### expression
evaluated and sent on each page request
```html
<%= java value %>

<%-- example --%>
<h1>A random number is: <%= Math.random() %></h1>
```

### scriptlet
extended piece of java and html
```html
<% Date date = new Date(); %>  
<h1>Hello World!</h1>  
<h2>The date is: <%=date %></h2>
```

### declaring a variable
what's the difference here?
```html
<%! int numVisits1 = 0; %>  
<% int numVisits2 = 0; %>
```
using <%! declares the variable once, at init, and persists across a session
<% evaluates every time the service method is re-called
	// in the generated java this is method-scoped, whereas the prior is instance-scoped

---
> a jsp can call itself with a form
> ```html
> <form action="this_page.jsp" method="post">
> 	<input type="submit" value="submit">
> </form>
> ```
> can also include other jsps like this
> ```html
> <jsp:include page="/WEB-INF/other_page.html"/>
> ```


to get the most out of jsp, we need to use the jsp standard tag library (jstl) and the expression language (el) : [[jstl_&_el]] 


---
## the service method
generated by the jsp page automatically to handle user request, mainly invoking doPost and doGet
generated by the container during the translation phase
handles every request that isn't jspInit


> #software_engineering #java 